<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PazienteDto.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">webbackend</a> &gt; <a href="index.source.html" class="el_package">com.glucoseguardian.webbackend.storage.dto</a> &gt; <span class="el_source">PazienteDto.java</span></div><h1>PazienteDto.java</h1><pre class="source lang-java linenums">package com.glucoseguardian.webbackend.storage.dto;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.glucoseguardian.webbackend.storage.entity.NumeroTelefono;
import com.glucoseguardian.webbackend.storage.entity.Paziente;
import java.io.Serializable;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.List;
import java.util.regex.Pattern;
import org.apache.commons.lang3.Validate;

/**
 * Rappresenta l'output delle funzioni di paziente.
 */
@JsonInclude(JsonInclude.Include.NON_ABSENT)
public class PazienteDto extends RisultatoDto implements Serializable {

  private String codiceFiscale;
  private String nome;
  private String cognome;
  private String dataNascita;
  private String indirizzo;
  private String telefono;
  private String email;
  private String sesso;
  private String tipoDiabete;
  private String comorbilita;
  private String farmaciAssunti;
  private Integer periodoDiMonitoraggio;

  private String idDottore;

  private List&lt;NumeroTelefonoDto&gt; numeriUtili;

  private TerapiaDto terapia;


<span class="fc" id="L40">  public PazienteDto() {</span>
<span class="fc" id="L41">  }</span>

  /**
   * Costruttore completo.
   */
  public PazienteDto(String codiceFiscale, String nome, String cognome, String dataNascita,
      String indirizzo, String telefono, String email, String sesso, String tipoDiabete,
      String comorbilita, String farmaciAssunti, Integer periodoDiMonitoraggio, String idDottore,
<span class="nc" id="L49">      List&lt;NumeroTelefonoDto&gt; numeriUtili, TerapiaDto terapia) {</span>
<span class="nc" id="L50">    this.codiceFiscale = codiceFiscale;</span>
<span class="nc" id="L51">    this.nome = nome;</span>
<span class="nc" id="L52">    this.cognome = cognome;</span>
<span class="nc" id="L53">    this.dataNascita = dataNascita;</span>
<span class="nc" id="L54">    this.indirizzo = indirizzo;</span>
<span class="nc" id="L55">    this.telefono = telefono;</span>
<span class="nc" id="L56">    this.email = email;</span>
<span class="nc" id="L57">    this.sesso = sesso;</span>
<span class="nc" id="L58">    this.tipoDiabete = tipoDiabete;</span>
<span class="nc" id="L59">    this.comorbilita = comorbilita;</span>
<span class="nc" id="L60">    this.farmaciAssunti = farmaciAssunti;</span>
<span class="nc" id="L61">    this.periodoDiMonitoraggio = periodoDiMonitoraggio;</span>
<span class="nc" id="L62">    this.idDottore = idDottore;</span>
<span class="nc" id="L63">    this.numeriUtili = numeriUtili;</span>
<span class="nc" id="L64">    this.terapia = terapia;</span>
<span class="nc" id="L65">  }</span>

  public String getCodiceFiscale() {
<span class="fc" id="L68">    return codiceFiscale;</span>
  }

  public void setCodiceFiscale(String codiceFiscale) {
<span class="fc" id="L72">    this.codiceFiscale = codiceFiscale;</span>
<span class="fc" id="L73">  }</span>

  public String getNome() {
<span class="fc" id="L76">    return nome;</span>
  }

  public void setNome(String nome) {
<span class="fc" id="L80">    this.nome = nome;</span>
<span class="fc" id="L81">  }</span>

  public String getCognome() {
<span class="fc" id="L84">    return cognome;</span>
  }

  public void setCognome(String cognome) {
<span class="fc" id="L88">    this.cognome = cognome;</span>
<span class="fc" id="L89">  }</span>

  public String getDataNascita() {
<span class="fc" id="L92">    return dataNascita;</span>
  }

  public void setDataNascita(String dataNascita) {
<span class="fc" id="L96">    this.dataNascita = dataNascita;</span>
<span class="fc" id="L97">  }</span>

  public String getIndirizzo() {
<span class="fc" id="L100">    return indirizzo;</span>
  }

  public void setIndirizzo(String indirizzo) {
<span class="fc" id="L104">    this.indirizzo = indirizzo;</span>
<span class="fc" id="L105">  }</span>

  public String getTelefono() {
<span class="fc" id="L108">    return telefono;</span>
  }

  public void setTelefono(String telefono) {
<span class="fc" id="L112">    this.telefono = telefono;</span>
<span class="fc" id="L113">  }</span>

  public String getSesso() {
<span class="fc" id="L116">    return sesso;</span>
  }

  public void setSesso(String sesso) {
<span class="fc" id="L120">    this.sesso = sesso;</span>
<span class="fc" id="L121">  }</span>

  public String getTipoDiabete() {
<span class="fc" id="L124">    return tipoDiabete;</span>
  }

  public void setTipoDiabete(String tipoDiabete) {
<span class="fc" id="L128">    this.tipoDiabete = tipoDiabete;</span>
<span class="fc" id="L129">  }</span>

  public String getComorbilita() {
<span class="fc" id="L132">    return comorbilita;</span>
  }

  public void setComorbilita(String comorbilita) {
<span class="fc" id="L136">    this.comorbilita = comorbilita;</span>
<span class="fc" id="L137">  }</span>

  public String getFarmaciAssunti() {
<span class="fc" id="L140">    return farmaciAssunti;</span>
  }

  public void setFarmaciAssunti(String farmaciAssunti) {
<span class="fc" id="L144">    this.farmaciAssunti = farmaciAssunti;</span>
<span class="fc" id="L145">  }</span>

  public Integer getPeriodoDiMonitoraggio() {
<span class="fc" id="L148">    return periodoDiMonitoraggio;</span>
  }

  public void setPeriodoDiMonitoraggio(Integer periodoDiMonitoraggio) {
<span class="fc" id="L152">    this.periodoDiMonitoraggio = periodoDiMonitoraggio;</span>
<span class="fc" id="L153">  }</span>

  public String getEmail() {
<span class="fc" id="L156">    return email;</span>
  }

  public void setEmail(String email) {
<span class="fc" id="L160">    this.email = email;</span>
<span class="fc" id="L161">  }</span>

  public List&lt;NumeroTelefonoDto&gt; getNumeriUtili() {
<span class="fc" id="L164">    return numeriUtili;</span>
  }

  public void setNumeriUtili(List&lt;NumeroTelefonoDto&gt; numeriUtili) {
<span class="fc" id="L168">    this.numeriUtili = numeriUtili;</span>
<span class="fc" id="L169">  }</span>

  public void setNumeriUtiliFromEntity(List&lt;NumeroTelefono&gt; numeriUtili) {
<span class="nc" id="L172">    this.numeriUtili = numeriUtili.stream().map(NumeroTelefonoDto::valueOf).toList();</span>
<span class="nc" id="L173">  }</span>

  public void setIdDottore(String idDottore) {
<span class="fc" id="L176">    this.idDottore = idDottore;</span>
<span class="fc" id="L177">  }</span>

  public String getIdDottore() {
<span class="fc" id="L180">    return idDottore;</span>
  }

  /**
   * Costruisce un PazienteDto a partire da un {@link Paziente}, il campo password non viene
   * popolato.
   */
  public static PazienteDto valueOf(Paziente paziente) {
<span class="nc" id="L188">    DateFormat dateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L189">    String dataNascitaPazienteDto = dateFormat.format(paziente.getDataNascita());</span>
<span class="nc" id="L190">    PazienteDto pazienteDto = new PazienteDto();</span>

<span class="nc" id="L192">    pazienteDto.setCodiceFiscale(paziente.getCodiceFiscale());</span>
<span class="nc" id="L193">    pazienteDto.setNome(paziente.getNome());</span>
<span class="nc" id="L194">    pazienteDto.setCognome(paziente.getCognome());</span>
<span class="nc" id="L195">    pazienteDto.setDataNascita(dataNascitaPazienteDto);</span>
<span class="nc" id="L196">    pazienteDto.setIndirizzo(paziente.getIndirizzo());</span>
<span class="nc" id="L197">    pazienteDto.setTelefono(paziente.getTelefono());</span>
<span class="nc" id="L198">    pazienteDto.setEmail(paziente.getEmail());</span>
<span class="nc" id="L199">    pazienteDto.setSesso(paziente.getSesso() + &quot;&quot;);</span>
<span class="nc" id="L200">    pazienteDto.setTipoDiabete(paziente.getTipoDiabete());</span>
<span class="nc" id="L201">    pazienteDto.setComorbilita(paziente.getComorbilita());</span>
<span class="nc" id="L202">    pazienteDto.setFarmaciAssunti(paziente.getFarmaciAssunti());</span>
<span class="nc" id="L203">    pazienteDto.setPeriodoDiMonitoraggio(pazienteDto.getPeriodoDiMonitoraggio());</span>
<span class="nc" id="L204">    pazienteDto.setNumeriUtiliFromEntity(paziente.getNumeriUtili());</span>
<span class="nc" id="L205">    pazienteDto.setIdDottore(paziente.getDottore().getCodiceFiscale());</span>
<span class="nc" id="L206">    return pazienteDto;</span>
  }

  /**
   *  validazione del paziente.
   */

  public void validate() throws IllegalArgumentException {
<span class="fc" id="L214">    Validate.notNull(codiceFiscale, &quot;Il codice fiscale non pu√≤ essere vuoto&quot;);</span>
<span class="fc bfc" id="L215" title="All 2 branches covered.">    Validate.isTrue(codiceFiscale.length() == 16,</span>
        &quot;La lunghezza del codice fiscale deve essere di 16 caratteri&quot;);

<span class="fc" id="L218">    Validate.notNull(nome, &quot;Il nome non puo essere vuoto&quot;);</span>
<span class="fc bfc" id="L219" title="All 4 branches covered.">    Validate.isTrue(nome.length() &lt;= 30 &amp;&amp; nome.length() &gt; 3,</span>
        &quot;La lunghezza del campo nome non √® valida&quot;);

<span class="fc" id="L222">    Validate.notNull(cognome, &quot;Il cognome non puo essere vuoto&quot;);</span>
<span class="fc bfc" id="L223" title="All 4 branches covered.">    Validate.isTrue(cognome.length() &lt;= 30 &amp;&amp; cognome.length() &gt; 2,</span>
        &quot;La lunghezza del cognome non √® valida&quot;);

<span class="fc" id="L226">    Validate.notNull(sesso, &quot;il sesso non puo' essere vuoto&quot;);</span>
<span class="fc" id="L227">    Pattern pattern = Pattern.compile(&quot;^M|F$&quot;);</span>
<span class="fc" id="L228">    Validate.isTrue(pattern.matcher(sesso).matches(), &quot;il sesso non √® valido&quot;);</span>

<span class="fc" id="L230">    Validate.notNull(dataNascita, &quot;la data di nascita non puo essere vuota&quot;);</span>
<span class="fc" id="L231">    Pattern pattern1 = Pattern.compile(</span>
        &quot;^(0[1-9]|[1-2]\\d|3[01])\\/(0[1-9]|1[0-2])\\/\\d\\d\\d\\d$&quot;);
<span class="fc" id="L233">    Validate.isTrue(pattern1.matcher(dataNascita).matches(),</span>
        &quot;la data nascita inserita non √® valida&quot;);

<span class="fc" id="L236">    SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
    try {
<span class="fc" id="L238">      long diff = dateFormat.parse(dataNascita).getTime() - new java.util.Date().getTime();</span>
<span class="fc bfc" id="L239" title="All 2 branches covered.">      Validate.isTrue(diff &lt; 0, &quot;La data di nascita √® nel futuro&quot;);</span>
<span class="nc" id="L240">    } catch (ParseException ex) {</span>
<span class="nc" id="L241">      throw new IllegalArgumentException(&quot;la data nascita inserita non √® valida&quot;);</span>
<span class="fc" id="L242">    }</span>

<span class="fc" id="L244">    Validate.notNull(email, &quot;la mail non puo essere assente&quot;);</span>
<span class="fc" id="L245">    Pattern pattern2 = Pattern.compile(&quot;^[a-zA-Z0-9.!#$%&amp;‚Äô*+/=?^_`{}~-]+@(?:[a-zA-Z0-9-\\.]+)\\w$&quot;);</span>
<span class="fc" id="L246">    Validate.isTrue(pattern2.matcher(email).matches(), &quot;L'email non √® valida&quot;);</span>

<span class="fc" id="L248">    Validate.notNull(telefono, &quot;telefono non puo essere assente&quot;);</span>
<span class="fc" id="L249">    Pattern pattern3 = Pattern.compile(&quot;^\\+?\\d{5,15}$&quot;);</span>
<span class="fc" id="L250">    Validate.isTrue(pattern3.matcher(telefono).matches(),</span>
        &quot;il campo numero di telefono non rispetta il formato&quot;);

<span class="fc" id="L253">    Validate.notNull(indirizzo, &quot;l'indirizzo non puo' essere vuoto&quot;);</span>
<span class="fc bfc" id="L254" title="All 4 branches covered.">    Validate.isTrue(indirizzo.length() &lt;= 50 &amp;&amp; indirizzo.length() &gt;= 4,</span>
        &quot;La lunghezza dell'indirizzo non √® valida&quot;);

<span class="fc" id="L257">    Validate.notNull(numeriUtili, &quot;numeriUtili non pu√≤ essere assente&quot;);</span>
<span class="fc bfc" id="L258" title="All 2 branches covered.">    for (NumeroTelefonoDto numeroTelefonoDto : numeriUtili) {</span>
<span class="fc" id="L259">      Validate.isTrue((pattern3.matcher(numeroTelefonoDto.getNumero())).matches(),</span>
          &quot;campo numeri utili non valido&quot;);
<span class="fc" id="L261">    }</span>

<span class="fc" id="L263">    Validate.notNull(tipoDiabete, &quot;tipo diabete non puo' essere assente&quot;);</span>
<span class="fc bfc" id="L264" title="All 4 branches covered.">    Validate.isTrue(tipoDiabete.length() &lt;= 10 &amp;&amp; tipoDiabete.length() &gt;= 1,</span>
        &quot;La lunghezza del tipo diabete non √® valida&quot;);

<span class="fc" id="L267">    Validate.notNull(comorbilita, &quot;commorbilit√† non puo' essere assente&quot;);</span>
<span class="fc bfc" id="L268" title="All 2 branches covered.">    Validate.isTrue(comorbilita.length() &lt;= 100, &quot;La lunghezza della commorbilit√† non √® valida&quot;);</span>

<span class="fc" id="L270">    Validate.notNull(farmaciAssunti, &quot;farmaci assunti non puo' essere vuoto&quot;);</span>
<span class="fc bfc" id="L271" title="All 2 branches covered.">    Validate.isTrue(farmaciAssunti.length() &lt;= 100, &quot;La lunghezza di farmaci assunti non √® valida&quot;);</span>

<span class="fc" id="L273">    Validate.notNull(terapia, &quot;La terapia non pu√≤ essere assente&quot;);</span>

<span class="fc" id="L275">    Validate.notNull(terapia.getFarmaci(), &quot;Farmaci non possono essere assenti&quot;);</span>
<span class="fc bfc" id="L276" title="All 4 branches covered.">    Validate.isTrue(terapia.getFarmaci().size() &gt; 0 &amp;&amp; terapia.getFarmaci().size() &lt; 20,</span>
        &quot;Numero Farmaci non valido&quot;);

<span class="fc" id="L279">    terapia.getFarmaci().forEach(AssunzioneFarmacoDto::validate);</span>


<span class="fc" id="L282">    Validate.notNull(periodoDiMonitoraggio, &quot;periodo di monitoraggio non puo essere assente&quot;);</span>
<span class="fc bfc" id="L283" title="All 2 branches covered.">    Validate.isTrue(periodoDiMonitoraggio &gt; 0, &quot;periodo di monitoraggio non valido&quot;);</span>


<span class="fc" id="L286">  }</span>

  public TerapiaDto getTerapia() {
<span class="fc" id="L289">    return terapia;</span>
  }

  public void setTerapia(TerapiaDto terapia) {
<span class="fc" id="L293">    this.terapia = terapia;</span>
<span class="fc" id="L294">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>